
// ============================================================================
// AWS Cloud Commander - Post-Setup Feature Tour
// ============================================================================
// Purpose: Guides users through key features after setup completion
//
// This tour is triggered automatically after successful setup (all 3 options)
// Shows 5 interactive cards explaining:
//   1. Notifications â†’ How to enable real-time AWS event notifications
//   2. Settings & Consents â†’ How to configure preferences and enable paid APIs
//   3. Commands & Help â†’ Overview of available /aws commands
//   4. Interactive Dashboard â†’ How to use the widget dashboard
//   5. Completion & Next Steps â†’ Quick start checklist and tips
//
// Each card includes action buttons to directly access features
// Users can skip the tour or navigate forward/backward
// ============================================================================
// Get tour step from button key
tourStep = ifnull(arguments.get("key"),"");
// Get user info safely
userName = "there";
userId = "";
if(user != null)
{
	userName = ifnull(user.get("first_name"),ifnull(user.get("name"),"there"));
	userId = ifnull(user.get("id"),"");
}
response = Map();
// ============================================================================
// CARD 1: NOTIFICATIONS FEATURE
// ============================================================================
if(tourStep == "feature_notifications" || tourStep == "")
{
	response = {"text":"*Enable Notifications*\n\nGet real-time updates from your AWS infrastructure:\n\nâ€¢ *EC2 Instances* - Start, stop, reboot events\nâ€¢ *S3 Buckets* - Creation and deletion alerts\nâ€¢ *CloudWatch Alarms* - Critical alerts and state changes\nâ€¢ *Lambda Functions* - Invocation notifications\nâ€¢ *RDS Databases* - Start, stop events\nâ€¢ *SNS Topics* - Message publishing alerts\nâ€¢ *Daily Cost Reports* - Daily spending summaries\nâ€¢ *Weekly Infrastructure Summary* - Weekly resource overview\n\n*Simply connect notification channels to stay informed!*\n\nClick below to configure notifications â†’","card":{"title":"Notifications","thumbnail":"https://static.vecteezy.com/system/resources/previews/009/394/759/non_2x/bell-icon-transparent-notification-free-png.png","theme":"modern-inline"},"buttons":{{"label":"Notifications","hint":"Set up notification channels","type":"+","action":{"type":"invoke.function","data":{"name":"handleButton"}},"key":"notification_settings"},{"label":"Skip","hint":"Continue to next feature","type":"-","action":{"type":"invoke.function","data":{"name":"featureTour"}},"key":"feature_settings"}},"navigation":true};
}
// ============================================================================
// CARD 2: SETTINGS & CONSENTS
// ============================================================================
else if(tourStep == "feature_settings")
{
	response = {"text":"*Settings & Consents*\n\nConfigure your preferences and enable advanced features:\n\n*Consents (Required for paid APIs):*\nâ€¢ *Cost Explorer* - View AWS spending and forecasts\nâ€¢ *AI Assistant* - Get AI-powered insights using Amazon Bedrock\nâ€¢ *Lambda Invoke* - Execute Lambda functions\nâ€¢ *SNS Publish* - Send messages to SNS topics\n\n*Preferences:*\nâ€¢ Default AWS region\nâ€¢ Other customization options\n\nClick below to open settings â†’","card":{"title":"Settings","thumbnail":"https://static.vecteezy.com/system/resources/thumbnails/047/463/967/small/illustration-of-gear-icon-free-png.png","theme":"modern-inline"},"buttons":{{"label":"Open Settings","hint":"Configure preferences and consents","type":"+","action":{"type":"invoke.function","data":{"name":"handleButton"}},"key":"settings_form"},{"label":"Next â†’","hint":"Continue to next feature","type":"+","action":{"type":"invoke.function","data":{"name":"featureTour"}},"key":"feature_commands"}},"navigation":true};
}
// ============================================================================
// CARD 3: COMMANDS & HELP
// ============================================================================
else if(tourStep == "feature_commands")
{
	response = {"text":"*Commands & Help*\n\nAccess AWS resources using slash commands:\n\n*Quick Commands:*\nâ€¢ `/aws` - Open interactive dashboard\nâ€¢ `/aws ai <question>` - Ask AI any questions\nâ€¢ `/aws status` - Check backend health\n\n*Service Commands:*\nâ€¢ `/aws ec2` - Manage EC2 instances\nâ€¢ `/aws s3` - Browse S3 buckets\nâ€¢ `/aws lambda` - View Lambda functions\nâ€¢ `/aws cost` - View cost reports\nâ€¢ `/aws alarms` - Monitor CloudWatch alarms\nâ€¢ `/aws logs` - View CloudWatch logs\nâ€¢ `/aws rds` - Manage RDS databases\nâ€¢ `/aws sns` - Manage SNS topics\n\n*ðŸ’¡ Tip:* Use `/aws help` anytime to see all commands!\n\nClick below to explore commands â†’","card":{"title":"Commands","thumbnail":"https://static.thenounproject.com/png/1406088-200.png","theme":"modern-inline"},"buttons":{{"label":"View Help","hint":"See all available commands","type":"+","action":{"type":"invoke.function","data":{"name":"handleButton"}},"key":"help"},{"label":"Next â†’","hint":"Continue to next feature","type":"+","action":{"type":"invoke.function","data":{"name":"featureTour"}},"key":"feature_widget"}},"navigation":true};
}
// ============================================================================
// CARD 4: INTERACTIVE DASHBOARD WIDGET
// ============================================================================
else if(tourStep == "feature_widget")
{
	response = {"text":"*Interactive Dashboard Widget*\n\nExperience AWS management like never before with our interactive dashboard!\n\n*âœ¨ Features:*\nâ€¢ *Real-time Resource Overview* - See EC2, S3, Lambda, and more at a glance\nâ€¢ *Interactive Actions* - Start/stop instances, browse buckets, invoke functions directly from the widget\nâ€¢ *Resource Management* - Manage your entire AWS infrastructure from one place\n\n*ðŸš€ How to Access:*\nâ€¢ Checkout the extension widget\nâ€¢ Or use *Bot Menu â†’ Dashboard*\n\nClick below to open dashboard â†’","card":{"title":"Interactive Dashboard","thumbnail":"https://png.pngtree.com/png-vector/20230302/ourmid/pngtree-dashboard-line-icon-vector-png-image_6626604.png","theme":"modern-inline"},"buttons":{{"label":"Open Dashboard","hint":"Explore interactive dashboard","type":"+","action":{"type":"invoke.function","data":{"name":"handleButton"}},"key":"dashboard"},{"label":"Next â†’","hint":"Continue to next feature","type":"+","action":{"type":"invoke.function","data":{"name":"featureTour"}},"key":"feature_complete"}},"navigation":true};
}
// ============================================================================
// CARD 5: COMPLETION & NEXT STEPS
// ============================================================================
else if(tourStep == "feature_complete")
{
	response = {"text":"*Next Steps:*\n1. *Configure Notifications* - Bot Menu â†’ Notifications\n2. *Enable Consents* - Bot Menu â†’ Settings\n4. *Try Commands* - Type `/aws help` to see all commands\n5. *Create Incident* - Bot Menu â†’ Create Incident\n\n_Welcome to AWS Cloud Commander! Happy managing!_ ðŸš€","card":{"title":"ðŸŽ‰ Setup Complete!","thumbnail":"https://www.monks.com/data/styles/738x363_crop/s3/2024-12/AWS.png?VersionId=AgciRGgmrM5MOD.WFIdw68QeG8kI.JR.&h=c74750f6&itok=q-7iCrYZ","theme":"prompt"},"buttons":{{"label":"Open Dashboard","hint":"Start using AWS Cloud Commander","type":"+","action":{"type":"invoke.function","data":{"name":"handleButton"}},"key":"dashboard"},{"label":"View Help","hint":"See all commands","type":"+","action":{"type":"invoke.function","data":{"name":"handleButton"}},"key":"help"}},"navigation":true};
}
// ============================================================================
// DEFAULT: START FROM BEGINNING
// ============================================================================
else
{
	response = {"text":"ðŸŽ‰ *Feature Tour*\n\nLet's explore what AWS Cloud Commander can do for you!\n\nClick below to start â†’","card":{"title":"Welcome to Features","thumbnail":"https://www.monks.com/data/styles/738x363_crop/s3/2024-12/AWS.png?VersionId=AgciRGgmrM5MOD.WFIdw68QeG8kI.JR.&h=c74750f6&itok=q-7iCrYZ","theme":"modern-inline"},"buttons":{{"label":"Start Tour","hint":"Begin feature exploration","type":"+","action":{"type":"invoke.function","data":{"name":"featureTour"}},"key":"feature_notifications"}},"navigation":true};
}
return response;
